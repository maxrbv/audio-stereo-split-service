# Проект "Сервис разбиения стерео аудио-файла"
Этот проект представляет собой прототип сервиса, разработанного для разбиения стерео аудио-файла на два отдельных файла
по каналам (левый и правый). Проект включает в себя несколько компонентов, таких как обработка сообщений из очереди RabbitMQ,
работа с Amazon S3 для хранения файлов, веб-апи для взаимодействия с сервисом, и сохранение истории обращений
в реляционной базе данных (PostgreSQL).

## Основные компоненты
1. Обработка сообщений из RabbitMQ
Сервис подписан на очередь сообщений RabbitMQ и ожидает получения запросов на разбиение аудиофайлов.
Когда сервис получает сообщение с данными аудиофайла, он выполняет разбиение на левый и правый каналы,
а затем загружает полученные файлы в Amazon S3.

2. Работа с Amazon S3
Для хранения разбитых аудиофайлов, сервис использует Amazon S3 - облачное хранилище файлов.
Созданные файлы сохраняются в S3 бакете, и сервис возвращает ссылки на S3 объекты после успешного разбиения.

3. Веб-апи для взаимодействия с сервисом
Сервис также предоставляет веб-апи, которое позволяет пользователям отправлять запросы на разбиение аудиофайлов напрямую.
Пользователи могут загружать аудиофайлы через веб-апи и получать ссылки на разбитые файлы после обработки.

4. Сохранение истории обращений в реляционной СУБД
Сервис сохраняет историю обращений, включая информацию о запросах на разбиение файлов, в реляционной базе данных.
Это позволяет отслеживать и анализировать обращения к сервису.

## Технологии
Проект использует следующие технологии и библиотеки:

* Python: Язык программирования для разработки сервиса.
* RabbitMQ: Брокер сообщений для обработки запросов.
* Amazon S3: Облачное хранилище файлов для сохранения разбитых аудиофайлов.
* FastAPI: Фреймворк для создания веб-апи.
* SQLAlchemy: Библиотека для взаимодействия с реляционной базой данных.
* Pydantic: Библиотека для валидации и сериализации данных во внутреннем API.

## Установка и запуск
1. Установите зависимости, указанные в файле requirements.txt, с помощью

    ```shell 
    pip install -r requirements.txt.
    ```

2. Определите переменные окружения в `.env` корне проекта следуя шаблону `.env.example`

3. Docker Compose

    ```shell
    docker-compose up --build -d
    ```

4. Запустите сервис FastAPI с помощью команды 
    ```shell
    python src/main.py
    ```

5. Запустите сервис очереди RabbitMQ с помощью команды
    ```shell
    python src/rabbitmq_service/consumer.py
    ```
   
## WebAPI URL
```shell
http://127.0.0.1:8000/docs
```
Сервис будет готов к принятию запросов на разбиение аудиофайлов через веб-апи и из очереди RabbitMQ.

